\makeatletter

%% AMS
\usepackage{amsmath,amssymb,latexsym}

%% Theorems
\usepackage{xcolor}
\definecolor{darkgreen}{rgb}{0,0.45,0} 
\usepackage[pagebackref,colorlinks,citecolor=darkgreen,linkcolor=darkgreen]{hyperref}
\usepackage{cleveref,aliascnt}
\usepackage{amsthm}
\def\defthm#1#2#3{%
  %% Ensure all theorem types are numbered with the same counter
  \newaliascnt{#1}{thm}
  \newtheorem{#1}[#1]{#2}
  \aliascntresetthe{#1}
  %% Tell cleveref's \cref what to call things
  \crefname{#1}{#2}{#3}}
\newtheorem{thm}{Theorem}[section]
\crefname{thm}{Theorem}{Theorems}
\theoremstyle{definition}
\defthm{defn}{Definition}{Definitions}
%\theoremstyle{remark}
\defthm{rmk}{Remark}{Remarks}
\defthm{advrmk}{Advanced Remark}{Advanced Remarks}
\newenvironment{adv}{\small\begin{advrmk}}{\end{advrmk}}
\defthm{eg}{Example}{Examples}
\defthm{egs}{Examples}{Examples}
\defthm{sage}{Sage}{Sages}

%% Reference format for sections
\crefformat{section}{\S#2#1#3}
\Crefformat{section}{Section~#2#1#3}
\crefrangeformat{section}{\S\S#3#1#4--#5#2#6}
\Crefrangeformat{section}{Sections~#3#1#4--#5#2#6}
\crefmultiformat{section}{\S\S#2#1#3}{ and~#2#1#3}{, #2#1#3}{ and~#2#1#3}
\Crefmultiformat{section}{Sections~#2#1#3}{ and~#2#1#3}{, #2#1#3}{ and~#2#1#3}
\crefrangemultiformat{section}{\S\S#3#1#4--#5#2#6}{ and~#3#1#4--#5#2#6}{, #3#1#4--#5#2#6}{ and~#3#1#4--#5#2#6}
\Crefrangemultiformat{section}{Sections~#3#1#4--#5#2#6}{ and~#3#1#4--#5#2#6}{, #3#1#4--#5#2#6}{ and~#3#1#4--#5#2#6}

%% Use the theorem counter for equations as well
\let\c@equation\c@thm
\numberwithin{equation}{section}

%% Pictures
\usepackage{tikz}
\usepackage{graphicx}

\makeatother
